import{a as g}from"./index-DvGKpqkK.js";const v={async criarSolicitacaoMedico(e){var a,p,r,i,f;const o=new FormData;o.append("crm",e.crm),o.append("especialidade",e.especialidade),o.append("instituicaoFormacao",e.instituicaoFormacao),o.append("anoFormacao",e.anoFormacao),o.append("residencia",e.residencia||""),o.append("instituicaoResidencia",e.instituicaoResidencia||""),o.append("anoResidencia",e.anoResidencia||""),o.append("experiencia",e.experiencia),o.append("motivacao",e.motivacao),(a=e.documentos)!=null&&a.diplomaMedicina&&o.append("diplomaMedicina",e.documentos.diplomaMedicina),(p=e.documentos)!=null&&p.certificadoResidencia&&o.append("certificadoResidencia",e.documentos.certificadoResidencia),(r=e.documentos)!=null&&r.comprovanteExperiencia&&o.append("comprovanteExperiencia",e.documentos.comprovanteExperiencia);const n="/medicos/solicitacoes/".trim(),t="/solicitacoes/".trim(),s=[n,t,"/medicos/solicitacoes/","/solicitacoes/medicos/","/solicitacoes/medico/"].filter(Boolean),u=m=>{const d=m.endsWith("/")?"":"/";return[m,`${m}${d}criar/`,`${m}${d}create/`]},l=Array.from(new Set(s.flatMap(u)));let c;for(const m of l)try{return console.debug("[solicitacaoService] Tentando endpoint:",m),(await g.post(m,o,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(d){const h=(i=d==null?void 0:d.response)==null?void 0:i.status;if(h===404||h===405){console.debug("[solicitacaoService] Endpoint não aceitou método (",h,"):",m),c=d;continue}throw d}throw c?(console.warn("[solicitacaoService] Nenhum endpoint aceitou POST. Último status:",(f=c==null?void 0:c.response)==null?void 0:f.status),c):new Error("Nenhum endpoint de criação aceitou a solicitação. Configure VITE_SOLICITACOES_MEDICOS_ENDPOINT.")},async listarMinhasSolicitacoes(e={}){var l,c;const o=[],n="/medicos/solicitacoes/".trim(),t="/solicitacoes/".trim();n&&o.push(n),t&&o.push(t),o.push("/medicos/solicitacoes/"),o.push("/solicitacoes/medicos/");const s={...e};s.limit!=null&&s.page_size==null&&(s.page_size=s.limit),s.page_size!=null&&s.limit==null&&(s.limit=s.page_size);let u;for(const a of o){const p=y(a);try{const i=(await g.get(p,{params:s})).data;return(Array.isArray(i==null?void 0:i.results)?i.results:Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray((l=i==null?void 0:i.data)==null?void 0:l.results)?i.data.results:Array.isArray(i==null?void 0:i.data)?i.data:Array.isArray(i)?i:[]).map(w)}catch(r){if(((c=r==null?void 0:r.response)==null?void 0:c.status)===404){u=r;continue}throw r}}throw u||new Error("Nenhum endpoint válido para listar solicitações do médico encontrado.")},async getSolicitacaoMedico(e){var u;const o=[],n="/medicos/solicitacoes/".trim(),t="/solicitacoes/".trim();n&&o.push(n),t&&o.push(t),o.push("/medicos/solicitacoes/"),o.push("/solicitacoes/medicos/");let s;for(const l of o){const c=y(l)+`${e}/`;try{const a=await g.get(c);return w(a.data||{})}catch(a){if(((u=a==null?void 0:a.response)==null?void 0:u.status)===404){s=a;continue}throw a}}throw s||new Error("Nenhum endpoint válido para obter a solicitação do médico encontrado.")}};function y(e){return e&&(e.endsWith("/")?e:`${e}/`)}function w(e={}){var o,n,t,s;return{id:e.id||e.pk||e.uuid||e.codigo||e.codigo_id||0,tipo:String(e.tipo||e.type||e.kind||"medico").toLowerCase(),nome:e.nome||e.name||((o=e.usuario)==null?void 0:o.nome)||((n=e.user)==null?void 0:n.name)||"—",email:e.email||((t=e.usuario)==null?void 0:t.email)||((s=e.user)==null?void 0:s.email)||"—",crm:e.crm||e.crm_numero||"",status:e.status||e.situacao||e.state||"pending",dataEnvio:e.dataEnvio||e.created_at||e.createdAt||e.data_criacao||e.submitted_at||new Date().toISOString(),documentos:Array.isArray(e.documentos)?e.documentos:e.documents||[],urgencia:String(e.urgencia||e.priority||"normal").toLowerCase(),especialidade:e.especialidade||""}}export{v as solicitacaoService};
